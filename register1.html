this is updated version of code 
